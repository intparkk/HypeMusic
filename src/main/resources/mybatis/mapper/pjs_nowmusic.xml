<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.study.springboot.dao.pjs_nowmusicDAO">
    
   <!-- 최신 트랙 조회 -->
   <select id="getnowmusictracks" resultType="trackinfoDTO">
		SELECT *
		FROM (
		    SELECT
		        t.track_id,
		        t.title,
		        t.like_count,
		        t.artist_id,
		        t.album_id,
		        a.artist,
		        t.youtube_url,
		        al.album_name,
		        al.album_img,
		        al.release_date
		    FROM
		        tracks t
		    JOIN
		        Artists a ON t.artist_id = a.artist_id
		    JOIN
		        ALBUMS al ON t.album_id = al.album_id
		    WHERE al.release_date > TO_DATE('2020-01-01', 'YYYY-MM-DD')
		    ORDER BY al.release_date DESC
		) WHERE ROWNUM &lt;= 50
   </select>
    
    <!-- 연도별 트랙 조회 -->
    <select id="getyearmusictracks" resultType="trackinfoDTO">
    	SELECT
		    t.track_id,
		    t.title,
		    t.like_count,
		    t.artist_id,
		    t.album_id,
		    t.genre,
		    a.artist,
		    t.youtube_url,
		    al.album_name,
		    al.album_img,
		    al.release_date
		FROM
		    tracks t
		JOIN
		    Artists a ON t.artist_id = a.artist_id
		JOIN
		    ALBUMS al ON t.album_id = al.album_id
		WHERE
		    EXTRACT(YEAR FROM al.release_date) = #{select_year}
		    AND ROWNUM &lt;= 50
    </select>
    
</mapper>